## 정규화

### 정규화란?
- ERD내에서 중복요소를 찾아 제거해 나가는 과정
  - 중복된 데이터는 많은 문제를 일으킨다
- 제 3 정규화 정도만 알면 설계하는데 무리가 없다
- 몇 가지 원칙만 지키면 정규화가 필요없는 ERD를 설계할 수 있다.

### 제 1정규화
- 엔티티에서 하나의 속성이 복수개의 값을 갖도록 설계되어 있을 때 하나의 속성이 단일 값을 갖도록 설계를 변경하는 과정  
![1정규화](http://i.imgur.com/cpExIQw.png)  
- 동일한 성격의 데이터를 서로 다른 속성에 저장할 때  
![1정규화2](http://i.imgur.com/GRy8lIM.png)  

### 제 2 정규화
- 주 식별자가 아닌 속성들 중에서 주식별자 전체가 아닌 일부 속성에 종속된 속성을 찾아 제거하는 과정 -> 부분 함수 종속 제거  
  (제거 : 다른 엔티티를 만들어 속성을 옮기는 것)
- 부서명은 주식별자 중 판매부서에 종속된 속성  
  (판매부서 번호가 정해지면 부서이름도 따라서 정해진다)  
![제2정규화](http://i.imgur.com/v6feEhh.png)  
![제2정규화2](http://i.imgur.com/zIkFBN6.png)  

### 제 3 정규화
- 주식별자가 아닌 속성들 중에서 종속 관계에 있는 속성을 찾아 제거하는 과정 -> 이행적 함수 종속 제거
- ex) 사원명은 판매사원번호에 종속  
      고객명, 고객주소는 고객번호에 종속  
      제품명, 단가는 저품번호에 종속  
![3정규화](http://i.imgur.com/o7WiWdg.png)  
![3정규화2](http://i.imgur.com/Ru7FGmH.png)  

### 정규화 과정은
- 결국 중복을 제거하기 위해 엔티티를 여러 개로 분리하는 과정
  - 정규화를 거치게 되면 자연히 엔티티의 수가 늘어나게 된다
- 엔티티를 그냥 분리하면 두 엔티티 사이에 관계가 없어져 버리므로 관계를 맺으면서 분리해야 한다


### 정규화가 필요 없는 설계 기법
- **제 1 정규화**
  - 중복 값의 저장이나 반복 속성이 존재하지 않도록 모델링
  - **원칙 : 장부나 전표의 머리부(header)와 서술부(detail)는 별도의 엔티티에 저장한다**  

![원칙1](http://i.imgur.com/4nGFBX0.png)

- **제 2,3 정규화**
  - 종속 관계에 있는 속성들을 제거
- **원칙 : 코드-코드 값의 관계에 있는 속성들은 별도의 엔티티로 구성한다(엔티티에 포함된 종속관계가 이에 해당)**  
![원칙2-1](http://i.imgur.com/hvxa8sT.png)  
![원칙2-2](http://i.imgur.com/eWahbdT.png)

## 도메인과 용어사전의 정의
### 도메인이란
- 엔티티의 속성들이 가질 수 있는 값들의 집합
- 관계형 이론에서의 도메인은 실제로는 구현이 얼벼기 때문에 대부분의 DBMS에서 도메인이란 속성에 대응하는 컬럼에 대한 데이터 타입과 길이를 의미
- 두 속성의 도메인이 같다는 말은 두 속성의 데이터 타입과 길이가 같다는 의미

### 도메인이 실무에서 잘 사용되지 않는 이유
- 도메인이 같은 속성이 많지 않다.
  - 도메인 수와 속성의 수가 비슷함
- 도메인 지정 시 사용하는 데이터 타입은 DBMS 제품에 따라 다를 수 있다.
- 도메인이 같은 속성이 여러 개 있는 경우는 도메인을 만들고, 그렇지 않은 속성들은 직접 데이터 타입을 지정한다.

### 도메인의 정의방법
1.  각 엔티티의 속성들을 모아 리스트를 만든다  
    스트레드 시트(엑셀)를 이용하면 편리  
    ![도메인정의1](http://i.imgur.com/MhhWSKE.png)  
2.  속성이름이 여러 단어를 포함할 경우 분리한다.  
    뒤에 있는 칸을 기준으로 나열  
    ![도메인정의2](http://i.imgur.com/fZ8M3nq.png)  
3.  마지막 단어를 기준으로 정렬한다  
![도메인정의3](http://i.imgur.com/Qx9S9yz.png)  
4.  도메인을 정한다  
    마지막 단어가 같은 속성들은 도메인이 같을 가능성이 있으므로 유의  
![도메인정의4](http://i.imgur.com/a2BXg0a.png)  
5.  도메인만 모아 정리  
    (중복제거 후 데이터 타입, 길이 결정)
    - 초기값 : 입력값이 없을 경우 자동적으로 입력되는 값
    - 값의 범위 : 저장될 값이 몇 가지로 정해져 있는 경우 저장될 값의 종류를 지정
    - 물리명 : 용어사전이 완성된 후 용어사전을 보고 입력  
    ![도메인정의5](http://i.imgur.com/BBnQfFk.png)  
- **정의된 도메인** : 물리적 설계 단계에서 데이터베이스 안에 저장되고, 테이블의 컬럼을 정의할 때 사용됨

### 용어사전이란
- 논리적 데이터베이스 설계나 물리적 데이터베이스 설계 시 사용되는 용어들의 의미를 정의해 놓은 문서
- 엔티티, 속성의 이름의 의미를 설명해 놓은 사전
- 동일한 의미의 용어를 설계자들이 서로 다르게 사용함으로 인한 혼란을 방지
- 논리설계 단계에서 한글로 작성한 엔티티, 속성이름을 물리적 설계 단계에서 영어 이름으로 바꿀 때 통일성을 기하려는 목적

## 모델
### 엔티티검토
- **엔티티가 적절히 구성되었는지의 여부**
  - 각 엔티티는 현실세계의 정보를 효과적으로 관리할 수 있는 구조인가?
  - 유사한 내용을 관리하는 엔티티는 없는가?
  - 통합 또는 분리되어야 할 엔티티는 없는가?
- **각 엔티티의 주식별자가 적절히 선정되었는지의 여부**
  - 주식별자는 인스턴스의 유일성을 보장해 주는가?
  - 주식별자에 불필요한 속성이 포함되어 있지는 않은가?
  - 주식별자에 속하는 속성이 너무 많지는 않은가?

### 속성검토
- 대상 업무에서 필요로 하는 정보를 관리하기 위해 속성이 잘 구성되었는가?
  - **엔티티** : 정보를 담기 위한 기본 단위
  - **속성** : 구체적인 정보 항목이 저장  
    -> 필요한 속성 누락 시 정보를 올바르게 관리 불가
- 검토사항
  - 누락된 속성의 추가
  - 여러 엔티티 사이에 중복된 속성이 존재하지는 않는가?
  - 속성의 성격상 코드화 해야하는 것은 없는가?

### 관계검토
- ERD 상에서 다른 엔티티와 관계가 없이 독립적으로 존재하는 엔티티는 없는가?
- 관계를 너무 복잡하게 맺지는 않았는가

### 상관모델링
- 데이터 모델과 검토가 끝나면 프로세스 모델과 통합하여 검토하는 과정
- 현실세계에서 데이터는 업무의 과정, 즉 특정 업무 프로세스에 의해 생성되거나 사용  
  -> 데이터는 특정 프로세스와 관련을 맺음
- 관련성이 올바로 파악되었는지를 확인하기 위해서는 상관 모델링 과정 필요  
![상관모델링](http://i.imgur.com/AZZ3Uu9.png)

## 논리적 설계를 물리적 설계로 전환하기

### 물리적 데이터베이스 설계
- 엔티티, 관계, 속성 등의 요소가 테이블, 컬럼, 키 등으로 변환
- 성능을 고려하여 반정규화 과정 시행
- 인덱스와 뷰를 설계  

![물리적 설계](http://i.imgur.com/CNTgGJM.png)

### 반정규화
  - 정규화의 반대 개념
  - 어느 정도의 중복은 감수하고 데이터베이스의 성능(특별히 검색 속도)을 향상 시키고자 ERD를 정규화 이전 상태로 변경하는 과정
    - 데이터베이스는 정보를 올바로 관리하는 것도 중요하지만 다수 사용자가 동시에 이용하는 속성상 일정 성능을 유지하는 것도 매우 중요
  - 정규화 과정은 엔티티들을 **분리**하는 형태로 진행이 된다면 반정규화 과정은 엔티티들을 **통합** 해 가는 형태로 진행
  - 반정규화를 하는 경우 데이터 모결성에 문제가 있을 수 있으므로 대비책 필요
  - **피피티보셈**

## 데이터베이스의 구축

### 역공학
- 이미 구축되어 있는 데이터베이스로부터 정보를 읽어 ERD를 그려주는 과정
  - 과거에 구축된 데이터베이스에는 많은 수의 테이블, 뷰, 인덱스 등의 객체들이 포함되어 있기 때문에 단순히 객체들의 목록을 보는 것만으로는 전체적인 데이터베이스의 구조나 업무를 알기 어렵다
  - 그렇기 때문에 역공학을 통해 보다 입체적으로 데이터베이스를 파악할 수 있다.

### 권한관리
- 데이터베이스 설계자는 사용자에 따라 정보에 대한 접근을 제한 할 수 있도록 보안 설계를 해야 할 필요가 있다
- 접근 권한의 지정을 용이하게 하기 위해 역할을 이용할 수 있다
